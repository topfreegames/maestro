
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../reference/OpenAPI/" rel="prev"/>
<link href="../EventsForwarding/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.15" name="generator"/>
<title>Autoscaling - Maestro</title>
<link href="../../assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="cyan" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#configuring-scheduler-autoscaling">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Maestro" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Maestro">
<img alt="logo" src="https://github.com/topfreegames/maestro/blob/main/docs/images/gopher-maestro.png?raw=true"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Maestro
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Autoscaling
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/topfreegames/maestro" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Maestro" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Maestro">
<img alt="logo" src="https://github.com/topfreegames/maestro/blob/main/docs/images/gopher-maestro.png?raw=true"/>
</a>
    Maestro
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/topfreegames/maestro" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../GettingStarted/">
<span class="md-ellipsis">
    Getting Started
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reference/Scheduler/">
<span class="md-ellipsis">
    Scheduler
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to-guides/User%20Guides/">
<span class="md-ellipsis">
    UserGuides
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Development/">
<span class="md-ellipsis">
    Developers
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reference/Architecture/">
<span class="md-ellipsis">
    Architecture
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reference/OpenAPI/">
<span class="md-ellipsis">
    OpenAPI
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Autoscaling
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Autoscaling
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuring-scheduler-autoscaling">
<span class="md-ellipsis">
      Configuring Scheduler Autoscaling
    </span>
</a>
<nav aria-label="Configuring Scheduler Autoscaling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      Prerequisites
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-outcomes">
<span class="md-ellipsis">
      Learning Outcomes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is">
<span class="md-ellipsis">
      What is
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-configure-and-enable-autoscaling">
<span class="md-ellipsis">
      How to configure and enable autoscaling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#policy-types">
<span class="md-ellipsis">
      Policy Types
    </span>
</a>
<nav aria-label="Policy Types" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#room-occupancy-policy">
<span class="md-ellipsis">
      Room Occupancy Policy
    </span>
</a>
<nav aria-label="Room Occupancy Policy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#room-occupancy-policy-parameters">
<span class="md-ellipsis">
      Room Occupancy Policy Parameters
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
<span class="md-ellipsis">
      Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-buffer-amount-policy">
<span class="md-ellipsis">
      Fixed Buffer Amount Policy
    </span>
</a>
<nav aria-label="Fixed Buffer Amount Policy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-buffer-policy-parameters">
<span class="md-ellipsis">
      Fixed Buffer Policy Parameters
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_1">
<span class="md-ellipsis">
      Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../EventsForwarding/">
<span class="md-ellipsis">
    Events Forwarding
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reference/Operations/">
<span class="md-ellipsis">
    Operations
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../reference/Kubernetes/">
<span class="md-ellipsis">
    Kubernetes Usage
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how-to-guides/Guidelines/">
<span class="md-ellipsis">
    Guidelines
    
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#configuring-scheduler-autoscaling">
<span class="md-ellipsis">
      Configuring Scheduler Autoscaling
    </span>
</a>
<nav aria-label="Configuring Scheduler Autoscaling" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
<span class="md-ellipsis">
      Prerequisites
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-outcomes">
<span class="md-ellipsis">
      Learning Outcomes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is">
<span class="md-ellipsis">
      What is
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-configure-and-enable-autoscaling">
<span class="md-ellipsis">
      How to configure and enable autoscaling
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#policy-types">
<span class="md-ellipsis">
      Policy Types
    </span>
</a>
<nav aria-label="Policy Types" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#room-occupancy-policy">
<span class="md-ellipsis">
      Room Occupancy Policy
    </span>
</a>
<nav aria-label="Room Occupancy Policy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#room-occupancy-policy-parameters">
<span class="md-ellipsis">
      Room Occupancy Policy Parameters
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example">
<span class="md-ellipsis">
      Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-buffer-amount-policy">
<span class="md-ellipsis">
      Fixed Buffer Amount Policy
    </span>
</a>
<nav aria-label="Fixed Buffer Amount Policy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-buffer-policy-parameters">
<span class="md-ellipsis">
      Fixed Buffer Policy Parameters
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#example_1">
<span class="md-ellipsis">
      Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Autoscaling</h1>
<h2 id="configuring-scheduler-autoscaling">Configuring Scheduler Autoscaling</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Have a game room container image that communicates with maestro through Maestro's rooms API</li>
</ul>
<h3 id="learning-outcomes">Learning Outcomes</h3>
<p>After finishing this tutorial you will understand how:</p>
<ul>
<li>to configure autoscaling policies for your scheduler</li>
</ul>
<h3 id="what-is">What is</h3>
<p>Autoscaling is an optional feature in which the user can choose and parametrize different autoscaling policies that maestro
will use to automatically scale the number of rooms in the scheduler.</p>
<p>Maestro has an internal process that periodically keeps checking if it needs to create or delete game rooms for the given scheduler,
if autoscaling is not configured or enabled, it will always try to maintain the current number of rooms equal to <strong>roomsReplicas</strong> scheduler property.
If autoscaling is configured <strong>and</strong> enabled, it will use the configured autoscaling policy to decide if it needs to <strong>scale up</strong> (create more rooms), 
<strong>scale down</strong> (delete rooms) or <strong>do nothing</strong>.</p>
<div class="mermaid">  flowchart TD
    finish((End))
    add_rooms_operation(Enqueue add rooms operation)
    remove_rooms_operation(Enqueue remove rooms)
    use_rooms_replicas(Use rooms replicas to calculate the desired number of rooms)
    autoscaling_enabled{Autoscaling configured and enabled?}
    decide_operation{Compare current number of rooms with the desired amount.}
    use_autoscaling[Use Autoscaling policy to calculate the desired number of rooms coerced in min-max range]
    autoscaling_enabled -- No --&gt; use_rooms_replicas;
    autoscaling_enabled -- Yes --&gt; use_autoscaling;
    use_autoscaling --&gt; decide_operation;
    use_rooms_replicas --&gt; decide_operation;
    decide_operation --  desired &gt; actual --&gt; add_rooms_operation --&gt; finish;
    decide_operation --  desired == actual --&gt; finish;
    decide_operation --  desired &lt; actual --&gt; remove_rooms_operation --&gt; finish;
</div>
<p>Currently, the sync interval is configured by environment variable <code>MAESTRO_WORKERS_HEALTHCONTROLLERINTERVAL</code>.</p>
<blockquote>
<p>By default, the scheduler does not have autoscaling configured.</p>
</blockquote>
<h3 id="how-to-configure-and-enable-autoscaling">How to configure and enable autoscaling</h3>
<p>To get autoscaling working in your scheduler, firstly you need to configure an autoscaling policy and enable it, this autoscaling
configuration resides in the root of the scheduler structure itself.</p>
<details>
<summary>YAML version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
name: String
game: String
...
autoscaling:
  enabled: true
  min: 1
  max: 10
  cooldown: 60
  policy:
    type: roomOccupancy
    parameters:
      ...
      // Will vary according to the policy type.
        </pre>
</div>
</details>
<details>
<summary>JSON version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
{
  "name": "test",
  "game": "multiplayer",
  ...
  "autoscaling": {
    "enabled": true,
    "min": 10,
    "max": 300,
    "cooldown": 60,
    "policy": {
      "type": "roomOccupancy",
      "parameters": {
        ...
        // Will vary according to the policy type.
      }
    }
  }
}
        </pre>
</div>
</details>
<ul>
<li><strong>enabled</strong> [boolean]: A value that can be true or false, indicating if the autoscaling feature is enabled/disabled for the given scheduler. Default: false.</li>
<li><strong>min</strong> [integer]: Minimum number of rooms the scheduler should have, it must be greater than zero. For zero value, disable autoscaling and set "roomsReplicas" to 0.</li>
<li><strong>max</strong> [integer]: Maximum number of rooms the scheduler can have. It must be greater than min, or can be -1 (to have no limit).</li>
<li><strong>cooldown</strong> [integer]: The cooldown period (in seconds) between <strong>downscaling</strong> operations. This is useful to avoid scale down too fast, 
  which can cause a lot of rooms to be deleted in a short period of time.</li>
<li><strong>policy</strong> [struct] : This field holds information regarding the autoscaling policy that will be used if the autoscaling feature is enabled:</li>
<li><strong>type</strong> [string]:  Define the policy type that will be used, must be one of the <a href="#policy-types">policy types maestro provides</a>.</li>
<li><strong>parameters</strong> [struct]: This field will contain arbitrary fields that will vary according to the chosen <a href="#policy-types">policy type</a>.</li>
</ul>
<hr/>
<h2 id="policy-types">Policy Types</h2>
<p>Maestro has a set of predefined policy types that can be used to configure the autoscaling, each policy will implement
a specific strategy for calculating the desired number of rooms and will have its configurable parameters.</p>
<p><strong>Note:</strong> Policy types are mutually exclusive. The parameters used will depend on the value of <code>autoscaling.policy.type</code>.</p>
<h3 id="room-occupancy-policy">Room Occupancy Policy</h3>
<p>The basic concept of this policy is to scale the scheduler up or down based on the actual room occupancy rate, by defining a "buffer" percentage
of ready rooms that Maestro must keep. The desired number of rooms will be given by the following formula:</p>
<p><code>desiredNumberOfRooms = ⌈(numberOfOccupiedRooms/ (1- readyTarget) )⌉</code></p>
<p>So basically Maestro will constantly try to maintain a certain percentage of rooms in <strong>ready</strong> state, by looking at the
actual room occupancy rate (number of rooms in <strong>occupied</strong> state).</p>
<h4 id="room-occupancy-policy-parameters">Room Occupancy Policy Parameters</h4>
<ul>
<li><strong>readyTarget</strong> [float]: The percentage (in decimal value) of rooms that Maestro should try to keep in <strong>ready</strong> state, must be a value greater than 0 and less than 1.</li>
<li><strong>downThreshold</strong> [float]: It adjusts how often maestro scale down Game Rooms, where 0.99 means that maestro will always scale down a Game Room when it is free (respecting the readyTarget), and a value close to 0 means that maestro will almost never scale down. Must be a value greater than 0 and less than 1.</li>
</ul>
<h4 id="example">Example</h4>
<details>
<summary>YAML version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
name: String
game: String
...
autoscaling:
  enabled: true
  min: 1
  max: 10
  policy:
    type: roomOccupancy
    parameters:
      roomOccupancy:
        readyTarget: 0.5
        </pre>
</div>
</details>
<details>
<summary>JSON version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
{
  "autoscaling": {
    "enabled": true,
    "min": 10,
    "max": 300,
    "policy": {
      "type": "roomOccupancy",
      "parameters": {
        "roomOccupancy": {
          "readyTarget": 0.5
        }
      }
    }
  }
}
        </pre>
</div>
</details>
<p>Below are some simulated examples of how the room occupancy policy will behave:</p>
<blockquote>
<p>Note that the autoscaling decision will always be limited by the min-max values! .</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align: center;">totalRooms</th>
<th style="text-align: center;">occupiedRooms</th>
<th style="text-align: center;">readyTarget</th>
<th style="text-align: center;">desiredNumberOfRooms</th>
<th style="text-align: center;">autoscalingDecision</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">Scale Up: +60</td>
</tr>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">Scale Down: -40</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">Scale Up: +8</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">Scale Down: -35</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">Scale Up: +40</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Scale Down: -5</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">Scale Up: +1</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">Scale Up: +1</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">Scale Up: +18</td>
</tr>
</tbody>
</table>
<h3 id="fixed-buffer-amount-policy">Fixed Buffer Amount Policy</h3>
<p>The Fixed Buffer Amount policy maintains a fixed number of rooms on top of the currently occupied rooms. This policy is useful when you want to ensure a consistent buffer of available rooms regardless of the occupancy rate.</p>
<p>The desired number of rooms will be given by the following formula:</p>
<pre><code>desiredNumberOfRooms = numberOfOccupiedRooms + fixedBufferAmount
</code></pre>
<p>Respecting autoscaling boundaries (min and max):</p>
<pre><code class="language-go">if desiredNumberOfRooms &lt; autoscaling.Min {
  desiredNumberOfRooms = autoscaling.Min
}

if autoscaling.Max != -1 &amp;&amp; desiredNumberOfRooms &gt; autoscaling.Max {
  desiredNumberOfRooms = autoscaling.Max
}
</code></pre>
<p>Maestro will constantly try to maintain the specified fixed amount of rooms in addition to the occupied rooms, ensuring there are always enough rooms available for new players.</p>
<h4 id="fixed-buffer-policy-parameters">Fixed Buffer Policy Parameters</h4>
<ul>
<li><strong>fixedBufferAmount</strong> [integer]: The fixed number of rooms that Maestro should maintain on top of the occupied rooms. Must be a value greater than 0 and less than the maximum number of rooms (max) when max is greater than 0.</li>
</ul>
<h4 id="example_1">Example</h4>
<details>
<summary>YAML version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
name: String
game: String
...
autoscaling:
  enabled: true
  min: 1
  max: 100
  policy:
    type: fixedBuffer
    parameters:
      fixedBuffer:
        amount: 50
        </pre>
</div>
</details>
<details>
<summary>JSON version</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
{
  "autoscaling": {
    "enabled": true,
    "min": 1,
    "max": 100,
    "policy": {
      "type": "fixedBuffer",
      "parameters": {
        "fixedBuffer": {
          "amount": 50
        }
      }
    }
  }
}
        </pre>
</div>
</details>
<details>
<summary>Coexisting with RoomOccupancy</summary>
<div class="highlight highlight-source-yaml position-relative overflow-auto">
<pre>
{
  "autoscaling": {
    "enabled": true,
    "min": 1,
    "max": 100,
    "policy": {
      "type": "fixedBuffer",
      "parameters": {
        "fixedBuffer": {
          "amount": 50
        },
        "roomOccupancy": {
          "readyTarget": 0.2,
          "downThreshold": 0.9
        }
      }
    }
  }
}
        </pre>
</div>
</details>
<p>Below are some simulated examples of how the fixed buffer amount policy will behave:</p>
<blockquote>
<p>Note that the autoscaling decision will always be limited by the min-max values!</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align: center;">totalRooms</th>
<th style="text-align: center;">occupiedRooms</th>
<th style="text-align: center;">fixedBufferAmount</th>
<th style="text-align: center;">desiredNumberOfRooms</th>
<th style="text-align: center;">autoscalingDecision</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">130</td>
<td style="text-align: center;">Scale Up: +30</td>
</tr>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">100</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">Scale Down: -20</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">Scale Up: +10</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">50</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">Scale Down: -20</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">Scale Up: +5</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">Do Nothing: 0</td>
</tr>
<tr>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Scale Down: -5</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">Scale Up: +5</td>
</tr>
<tr>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Scale Up: +3</td>
</tr>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">Scale Up: +8</td>
</tr>
</tbody>
</table>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
    2025-07-18
  </span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
<script src="https://unpkg.com/mermaid@9.0.0/dist/mermaid.min.js"></script><script>mermaid.initialize({});</script></body>
</html>